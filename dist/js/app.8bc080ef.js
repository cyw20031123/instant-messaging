(function(t){function e(e){for(var a,s,o=e[0],u=e[1],c=e[2],p=0,f=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&f.push(r[s][0]),r[s]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(t[a]=u[a]);l&&l(e);while(f.length)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var u=n[o];0!==r[u]&&(a=!1)}a&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var a={},r={app:0},i=[];function s(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=a,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(n,a,function(e){return t[e]}.bind(null,a));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var l=u;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1664:function(t,e,n){"use strict";n("9f36")},2546:function(t,e,n){"use strict";n("8574")},"4fa5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("transition",{attrs:{mode:"out-in"}},[n(t.page,{tag:"component",attrs:{name:t.name},on:{up:t.up}})],1)],1)},i=[],s=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-section container-fluid text-center SignIn"},[n("div",{staticClass:"LoginInterface"},[n("div",{staticClass:"button"},[n("div",{style:t.pattern?"color:lightskyblue":"",on:{click:function(e){t.pattern=!0}}},[t._v(" 登录 ")]),n("div",{style:t.pattern?"":"color:lightskyblue",on:{click:function(e){t.pattern=!1}}},[t._v(" 注册 ")])]),n("transition",{attrs:{mode:"out-in"}},[n(t.pattern?"Signin":"Registrant",{tag:"component",on:{up:t.up}})],1)],1)])}),o=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"signin"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"name",attrs:{type:"name",placeholder:"请输入账号"},domProps:{value:t.name},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.next.apply(null,arguments)},input:function(e){e.target.composing||(t.name=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],ref:"password",staticClass:"password",attrs:{type:"password",placeholder:"请输入密码"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.signin.apply(null,arguments)},input:function(e){e.target.composing||(t.password=e.target.value)}}}),n("div",{staticClass:"Forget",on:{click:t.Forget}},[t._v("忘记密码")]),n("input",{staticClass:"btn btn-info input",attrs:{type:"button",value:"登录"},on:{click:t.signin}})])},c=[],l={name:"Signin",data:function(){return{name:"",password:""}},methods:{next:function(){this.$refs.password.focus()},signin:function(){var t=this;AV.User.logIn(this.name,this.password).then((function(e){t.$emit("up",t.name)}),(function(t){alert("账户或密码错误！￣へ￣")}))},Forget:function(){var t=prompt("请输入你的邮箱( ･´ω`･ )");null!=t&&""!=t?(AV.User.requestPasswordReset(t),alert("请查看您的邮箱(*･ω< ) ")):alert("什么都没有输入哦！")}}},p=l,f=(n("1664"),n("2877")),d=Object(f["a"])(p,u,c,!1,null,"0c8f00a5",null),m=d.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"registrant"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"name",attrs:{type:"name",placeholder:"请设置账号"},domProps:{value:t.name},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.next1.apply(null,arguments)},input:function(e){e.target.composing||(t.name=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],ref:"text",staticClass:"password",attrs:{type:"text",placeholder:"请设置密码"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.next2.apply(null,arguments)},input:function(e){e.target.composing||(t.password=e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],ref:"email",staticClass:"email",attrs:{type:"email",placeholder:"请设置邮箱"},domProps:{value:t.email},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.registrant.apply(null,arguments)},input:function(e){e.target.composing||(t.email=e.target.value)}}}),n("input",{staticClass:"btn btn-info",attrs:{type:"button",value:"注册"},on:{click:t.registrant}})])},v=[],g={name:"Registrant",data:function(){return{name:"",password:"",email:""}},methods:{next1:function(){this.$refs.text.focus()},next2:function(){this.$refs.email.focus()},registrant:function(){var t=AV.Object.extend("UserName"),e=new t;e.set("name",this.name);var n=new AV.User;n.setUsername(this.name),n.setPassword(this.password),n.setEmail(this.email),this.name="",this.password="",this.email="",n.signUp().then((function(t){e.save(),alert("注册成功啦！快去登录吧！")}),(function(t){alert("注册失败啦！换个名字试一试？")}))}}},y=g,b=(n("2546"),Object(f["a"])(y,h,v,!1,null,"cbb327fa",null)),w=b.exports,k={components:{Signin:m,Registrant:w},name:"SignIn",data:function(){return{pattern:!0}},methods:{up:function(t){this.$emit("up",["Chat",t])}},created:function(){var t=AV.User.current();t&&this.$emit("up",["Chat",t.attributes.username])}},x=k,C=(n("6cce"),Object(f["a"])(x,s,o,!1,null,"e9fb22c0",null)),O=C.exports,_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:" container-fluid text-center Chat"},[n("div",{attrs:{id:"Interface"}},[n("div",{staticClass:"assembly"},[n("div",{staticClass:"who"},[n("div",[t._v(t._s(t.who))])]),n("div",{ref:"chatbox",attrs:{id:"DisplayPanel"}},t._l(t.data[t.subscript].data,(function(e,a){return n("div",{key:a,staticClass:"information",class:e[0]},[t._v(" "+t._s(e[1])+" ")])})),0),n("div",{attrs:{id:"InpuBox"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"input",attrs:{placeholder:"说点什么吧!",type:"text"},domProps:{value:t.input},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.get()},input:function(e){e.target.composing||(t.input=e.target.value)}}}),n("input",{staticClass:"btn btn-info",attrs:{type:"button",value:"发送"},on:{click:function(e){return t.get()}}})])]),n("div",{attrs:{id:"GoodFriend"}},[n("div",{attrs:{id:"name"}},t._l(t.username,(function(e,a){return n("div",{key:a,ref:a,refInFor:!0,staticClass:"name",on:{click:function(e){return t.change(a)}}},[t._v(" "+t._s(e)+" ")])})),0),n("input",{staticClass:"btn btn-danger button",attrs:{type:"button",value:"退出登录"},on:{click:function(e){return t.LogOut()}}})])])])},S=[],j=n("b85c"),I=(n("d3b7"),n("7db0"),n("d81d"),AV),P=I.Realtime,E=I.TextMessage,$=I.Event,A=new P({appId:"coJvzqIgHkiuWHgUDuMtOC37-gzGzoHsz",appKey:"y9tnM5dWs5eC3ubS6OXIrSqm",server:"https://cojvzqig.lc-cn-n1-shared.com"}),M={props:["name"],name:"Chat",data:function(){return{input:"",data:[{name:"选择一个用户开始聊天吧~",data:[]}],who:"选择一个用户开始聊天吧~",username:[],Signin:"",subscript:0}},methods:{change:function(t){var e=this;this.user(t).then((function(){e.bottom()}));var n=this.$refs[t];n[0].className="name"},user:function(t){return this.who=this.username[t],this.subscript=t+1,Promise.resolve("true")},bottom:function(){this.$refs.chatbox.scrollTop=999999999},get:function(){var t=this;if("选择一个用户开始聊天吧~"!=this.who){if(""!==this.input){var e=this.input;this.input="",this.Signin.createConversation({members:[this.who],name:this.name+" & "+this.who,unique:!0}).then((function(n){n.send(new E(e)).then((function(e){var n,a=Object(j["a"])(t.data);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.name==t.who&&(r.data.push(["user",e.text]),setTimeout((function(){t.bottom()}),10))}}catch(i){a.e(i)}finally{a.f()}})).catch((function(){alert("发送失败啦！")}))}))}}else alert("请选择一个用户开始通讯哦")},LogOut:function(){AV.User.logOut(),this.Signin.close().then((function(){})),this.$emit("up","SignIn")}},mounted:function(){var t=this,e=new AV.Query("UserName");e.find().then((function(e){var n,a=Object(j["a"])(e);try{for(a.s();!(n=a.n()).done;){var r=n.value,i=r.attributes.name;i!=t.name&&(t.username.push(i),t.data.push({name:i,data:[]}))}}catch(s){a.e(s)}finally{a.f()}})),A.createIMClient(this.name).then((function(e){t.Signin=e;var n=e.getQuery();n.contains("name",t.name),n.find().then((function(e){e.map((function(e){var n,a,r=e.members,i=Object(j["a"])(r);try{for(i.s();!(a=i.n()).done;){var s=a.value;s!==t.name&&(n=s)}}catch(o){i.e(o)}finally{i.f()}e.queryMessages({limit:100}).then((function(e){for(var a=0;a<t.data.length;a++)if(t.data[a].name==n)for(var r=0;r<e.length;r++)e[r].from==t.name?t.data[a].data.push(["user",e[r].text]):t.data[a].data.push(["reply",e[r].text])}))}))}))})),A.createIMClient(this.name).then((function(e){e.on($.INVITED,(function(t,e){})),e.on($.MESSAGE,(function(e,n){var a,r=Object(j["a"])(t.data);try{for(r.s();!(a=r.n()).done;){var i=a.value;if(i.name==e.from){i.data.push(["reply",e.text]),setTimeout((function(){t.bottom()}),10);for(var s=0;s<t.username.length;s++)if(i.name===t.username[s]&&t.who!=i.name){var o=t.$refs[s];o[0].className="received"}}}}catch(u){r.e(u)}finally{r.f()}}))}))}},U=M,N=(n("8eaf"),Object(f["a"])(U,_,S,!1,null,"4e16f089",null)),V=N.exports,z={name:"App",components:{SignIn:O,Chat:V},data:function(){return{page:"SignIn",name:""}},methods:{up:function(t){t instanceof Array?(this.page=t[0],this.name=t[1]):this.page=t}}},q=z,T=(n("95b2"),Object(f["a"])(q,r,i,!1,null,"5f80d3cc",null)),H=T.exports,R=AV;R.Query,R.User;AV.init({appId:"coJvzqIgHkiuWHgUDuMtOC37-gzGzoHsz",appKey:"y9tnM5dWs5eC3ubS6OXIrSqm",serverURL:"https://cojvzqig.lc-cn-n1-shared.com"}),a["a"].config.assetsPublicPath="./",new a["a"]({render:function(t){return t(H)}}).$mount("#app")},"6cce":function(t,e,n){"use strict";n("d232")},8574:function(t,e,n){},"8eaf":function(t,e,n){"use strict";n("f20e")},"95b2":function(t,e,n){"use strict";n("4fa5")},"9f36":function(t,e,n){},d232:function(t,e,n){},f20e:function(t,e,n){}});
//# sourceMappingURL=app.8bc080ef.js.map